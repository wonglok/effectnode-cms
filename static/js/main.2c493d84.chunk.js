(this["webpackJsonp@effectnode/cms-example"]=this["webpackJsonp@effectnode/cms-example"]||[]).push([[1],{56:function(e,t,n){var a={"./lok.myFristNode.js":[84,0,5],"./lok.mySecondNode.js":[85,0,4,6]};function o(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(o)}))}o.keys=function(){return Object.keys(a)},o.id=56,e.exports=o},65:function(e,t,n){e.exports=n(83)},66:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);n(66);var a=n(0),o=n.n(a),r=n(59),i=n.n(r),c=n(62),l=n(16),u=n(11),s=n(2),d=n(4),f=n(19),p=n.n(f),m=n(25),g=n(13),v=n(15),y=n(3),b=n(31),h=(n(72),n(74),n(91)),E=n(88),w=n(90),x=n(89),I=function(){return"_"+Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9)},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=I(),n={exportJSON:function(){return JSON.parse(JSON.stringify(e))},getNameSpcaeID:function(){return t},onChange:function(n,a){var o="".concat(t),r=function(){a(e[n])};return window.addEventListener("".concat(o,"-").concat(n),r),function(){window.removeEventListener("".concat(o,"-").concat(n),r)}},useReactiveKey:function(n,o){Object(a.useEffect)((function(){var a="".concat(t),r=function(){o(e[n])};return window.addEventListener("".concat(a,"-").concat(n),r),function(){window.removeEventListener("".concat(a,"-").concat(n),r)}}),[])},makeKeyReactive:function(e){var n=Object(a.useState)(0),o=Object(g.a)(n,2),r=o[0],i=o[1];Object(a.useEffect)((function(){var n="".concat(t),a=function(){i((function(e){return e+1}))};return window.addEventListener("".concat(n,"-").concat(e),a),function(){window.removeEventListener("".concat(n,"-").concat(e),a)}}),[r])},onChangeAny:function(n){var a="".concat(t),o=function(){n(e[key])};return window.addEventListener("".concat(a),o),function(){window.removeEventListener("".concat(a),o)}},notifyKeyChange:function(e){window.dispatchEvent(new CustomEvent("".concat(t,"-").concat(e),{detail:{}}))}},o=new Proxy(e,{get:function(e,t){return n[t]?n[t]:e[t]},set:function(e,n,a){return e[n]=a,"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("".concat(t,"-").concat(n),{detail:{}})),!0}});return o}({listing:[],listingReload:0,layouts:[],layoutsReload:0,canvasID:!1,canvasOwnerID:!1,overlay:"",cursorMode:"ready",hovering:"floor",draggingNodeID:!1,draggingIOID:!1,addNodeTitle:"mytitle",cursorAt:new y.Vector3,dragStartPos:new y.Vector3,moved:0,isDown:!1,nodes:[],connections:[],currentEditSocketID:!1,currentEditNodeID:!1,firebaseConfig:!1}),C=new Map;function k(e){var t=e.firebaseConfig;return C.has("app")||C.set("app",b.a.initializeApp(t)),C.has("database")||C.set("database",b.a.database()),C.has("setup-listen-login")||(C.set("setup-listen-login",!0),C.get("app").auth().onAuthStateChanged((function(e){e?C.set("user",e):C.delete("user")}))),C.has("setup-do-login")||(C.set("setup-do-login",!0),console.log("[Firebase]: done setup")),C.get("app")}var O=function(e){var t=e.firebaseConfig;return new Promise((function(e){k({firebaseConfig:t});var n=setInterval((function(){C.has("user")&&(clearInterval(n),e({user:C.get("user"),db:C.get("database")}))}))}))},j=function(){var e=Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b.a.auth().signOut());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=b.a,N=function(){function e(){Object(s.a)(this,e)}return Object(d.a)(e,null,[{key:"addCodeBlock",value:function(e){var t=e.point;D.overlay="",D.cursorMode="ready",D.hovering="floor";var n=S.database().ref("/canvas/".concat(D.canvasID,"/").concat(D.canvasOwnerID,"/nodes")).push(),a=I();n.set({title:D.addNodeTitle,_id:a,position:t.toArray(),inputs:[{_id:I(),type:"input",nodeID:a},{_id:I(),type:"input",nodeID:a},{_id:I(),type:"input",nodeID:a},{_id:I(),type:"input",nodeID:a},{_id:I(),type:"input",nodeID:a}],outputs:[{_id:I(),type:"output",nodeID:a},{_id:I(),type:"output",nodeID:a},{_id:I(),type:"output",nodeID:a},{_id:I(),type:"output",nodeID:a},{_id:I(),type:"output",nodeID:a}]})}},{key:"saveCodeBlock",value:function(e){var t=e.node;S.database().ref("/canvas/".concat(D.canvasID,"/").concat(D.canvasOwnerID,"/nodes/").concat(t._fid)).set(t.data)}},{key:"removeCodeBlockByID",value:function(e){var t=e.nodeID;S.database().ref("/canvas/".concat(D.canvasID,"/").concat(D.canvasOwnerID,"/nodes/").concat(t)).remove()}},{key:"addLink",value:function(e){var t=e.input,n=e.output;S.database().ref("/canvas/".concat(D.canvasID,"/").concat(D.canvasOwnerID,"/connections")).push().set({_id:I(),input:t,output:n})}},{key:"removeLinkByID",value:function(e){var t=e.linkID;S.database().ref("/canvas/".concat(D.canvasID,"/").concat(D.canvasOwnerID,"/connections/").concat(t)).remove()}},{key:"removeCurrentNodeAndConnections",value:function(){var t=D.currentEditNodeID,n=D.nodes.find((function(e){return e._fid===t}));if(n){var a=n.data._id;D.connections.filter((function(e){return e.data.input.nodeID===a||(e.data.output.nodeID===a||void 0)})).map((function(e){return e._fid})).forEach((function(t){e.removeLinkByID({linkID:t})})),e.removeCodeBlockByID({nodeID:t}),D.currentEditNodeID=!1}}}]),e}();function L(e){var t=e.codes,n=void 0===t?[]:t;return D.makeKeyReactive("overlay"),Object(a.useEffect)((function(){var e=function(e){"escape"===e.key.toLowerCase()&&(D.overlay="")};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}})),D.overlay?o.a.createElement("div",{style:{position:"fixed",top:"0px",left:"0px",width:"100%",backgroundColor:"rgba(255,255,255,0.92)"}},"main"===D.overlay&&o.a.createElement(R,{codes:n}),"node"===D.overlay&&o.a.createElement(P,{codes:n}),"addCodeBlock"===D.overlay&&o.a.createElement("div",{style:{width:"100%",position:"absolute",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.95)"}},o.a.createElement("div",{style:{width:"100%",backgroundColor:"rgba(40,255,40,1.0)"},className:"bg-green-400"},o.a.createElement("div",{style:{width:"100%",padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",{style:{width:"100%"}},"Click on Floor to Add")))),D.overlay&&o.a.createElement("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:10}},o.a.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",fill:"black",onClick:function(){D.overlay=""},onPointerDown:function(){D.overlay=""},style:{cursor:"pointer"}},o.a.createElement("path",{d:"M12 11.293l10.293-10.293.707.707-10.293 10.293 10.293 10.293-.707.707-10.293-10.293-10.293 10.293-.707-.707 10.293-10.293-10.293-10.293.707-.707 10.293 10.293z"})))):o.a.createElement("div",null)}function R(e){var t=e.codes,n=void 0===t?[]:t;return o.a.createElement("div",{style:{width:"100%",height:"100%",position:"fixed",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.92)"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",null,"Getting Started"))),o.a.createElement("div",{style:{padding:"15px",fontSize:"20px",fontFamily:"Arial"}},o.a.createElement("div",null,"Add New CodeBlock")),n.map((function(e){return o.a.createElement("div",{key:e.title,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(){D.addNodeTitle=e.title,D.hovering="floor",D.cursorMode="addCodeBlock",D.overlay="addCodeBlock"}},e.title))})))}function P(e){var t=e.codes,n=void 0===t?[]:t,r=Object(a.useMemo)((function(){var e=D.currentEditNodeID,t=D.nodes.find((function(t){return t._fid===e})),n=[],a=[];if(t){var o=t.data._id;n=D.connections.filter((function(e){if(e.data.input.nodeID===o)return!0})),a=D.connections.filter((function(e){if(e.data.output.nodeID===o)return!0}))}return{node:t,inputLinks:n,outputLinks:a}})),i=r.node,c=r.outputLinks,l=r.inputLinks,u=Object(a.useState)(0),s=Object(g.a)(u,2)[1],d=Object(a.useState)(i.data.title),f=Object(g.a)(d,2),p=f[0],m=f[1];return o.a.createElement("div",{style:{width:"100%",height:"100%",position:"fixed",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"lightblue"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",null,"Node Settings"))),o.a.createElement("div",{style:{padding:"15px",fontSize:"20px",fontFamily:"Arial"}},o.a.createElement("div",null,"Node using logic:"," ",o.a.createElement("div",{style:{borderColor:"black",display:"inline-block",border:"black solid 1px"}},o.a.createElement("select",{style:{appearance:"none",width:"100%",height:"100%"},value:p,onChange:function(e){var t=e.target.value;i.data.title=t,N.saveCodeBlock({node:i}),m(t)}},n.map((function(e,t){return o.a.createElement("option",{key:t+e.title,value:e.title},e.title)})))))),l.length>0&&o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Inputs")),l.map((function(e){var t=e.data.input._id,n=i.data.inputs.findIndex((function(e){return e._id===t})),a=i.data.inputs.find((function(e){return e._id===t})),r=D.nodes.find((function(e){return e.data._id===a.nodeID}));return o.a.createElement("div",{key:e._fid,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(t){"red"===t.currentTarget.style.color&&(N.removeLinkByID({linkID:e._fid}),s((function(e){return e+1}))),t.currentTarget.style.color="red"}},'Remove Input at label "',n,'"'," ",r.data.title&&o.a.createElement("span",null,'which is conncted to "',r.data.title,'"')))})),c.length>0&&o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Outputs")),c.map((function(e){var t=e.data.output._id,n=i.data.outputs.findIndex((function(e){return e._id===t})),a=i.data.outputs.find((function(e){return e._id===t})),r=D.nodes.find((function(e){return e.data._id===a.nodeID}));return o.a.createElement("div",{key:e._fid,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(t){"red"===t.currentTarget.style.color&&(N.removeLinkByID({linkID:e._fid}),s((function(e){return e+1}))),t.currentTarget.style.color="red"}},'Remove Output at label "',n,'"'," ",r.data.title&&o.a.createElement("span",null,'which is conncted to "',r.data.title,'"')))})),o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Remove Node & Connections")),o.a.createElement("div",{style:{padding:"15px",textDecoration:"underline",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(){window.confirm("remove item")&&(N.removeCurrentNodeAndConnections(),D.overlay="")}},"Remove")))}function _(){var e=Object(v.c)().camera,t=Object(a.useRef)();Object(a.useEffect)((function(){e.position.X=0,e.position.y=50,e.position.z=75,e.fov=45,e.lookAt(0,0,0),e.near=.1,e.far=1e4,e.updateProjectionMatrix()}),[t.current]);var n=function(){"floor"===D.hovering?"ready"===D.cursorMode?document.body.style.cursor="grab":"pan"===D.cursorMode?document.body.style.cursor="grabbing":"addCodeBlock"===D.cursorMode&&(document.body.style.cursor="crosshair"):"object"===D.hovering?document.body.style.cursor="pointer":(D.hovering,document.body.style.cursor="")};D.useReactiveKey("overlay",n),D.useReactiveKey("cursorMode",n),D.useReactiveKey("hovering",n),D.useReactiveKey("draggingNodeID",(function(){t.current.enabled=!D.draggingNodeID})),D.useReactiveKey("draggingIOID",(function(){t.current.enabled=!D.draggingIOID}));var r={onPointerDown:function(e){var t=e.point;D.isDown=!0,"ready"===D.cursorMode&&(D.cursorMode="pan"),"addCodeBlock"===D.cursorMode&&N.addCodeBlock({point:t})},onPointerUp:function(e){e.point;D.isDown=!1,"pan"===D.cursorMode&&(D.cursorMode="ready"),setTimeout((function(){D.draggingIOID&&(D.draggingIOID=!1)}),100)},onPointerEnter:function(){},onPointerMove:function(e){D.moved++,e.stopPropagation(),"floor"!==D.hovering&&(D.hovering="floor"),D.cursorAt.copy(e.point)}};return Object(a.useEffect)((function(){window.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),window.addEventListener("touchmove",(function(e){e.preventDefault()}),{passive:!1})}),[]),o.a.createElement("group",null,o.a.createElement(h.a,{screenSpacePanning:!1,ref:t}),o.a.createElement("mesh",Object.assign({visible:!1,name:"floor","rotation-x":-.5*Math.PI},r),o.a.createElement("planeBufferGeometry",{args:[1e3,1e3,2,2]}),o.a.createElement("shaderMaterial",{fragmentShader:"void main (void) { discard; }"})),o.a.createElement("gridHelper",{raycast:function(){},"position-y":.01,args:[1e3,100,"#232323","#232323"]}))}function A(e){var t=Object.assign({},e),n=Object(a.useRef)();return Object(v.b)((function(e){var t=e.clock.getElapsedTime();n.current.rotation.z=y.MathUtils.lerp(n.current.rotation.z,Math.sin(t/4)/20,.1),n.current.position.y=y.MathUtils.lerp(n.current.position.y,(-5+Math.sin(t))/5,.1)})),o.a.createElement("group",Object.assign({raycast:E.a,onPointerEnter:function(){D.hovering="object"},onPointerLeave:function(){D.hovering="floor"},onPointerDown:function(e){e.stopPropagation(),e.target.setPointerCapture(e.pointerId)},onPointerUp:function(e){D.overlay="main",D.hovering="overlay",e.stopPropagation(),e.target.releasePointerCapture(e.pointerId)},ref:n},t),o.a.createElement("pointLight",{"position-x":0,"position-z":-2,"position-y":2}),o.a.createElement("group",{"rotation-x":0*Math.PI,position:[0,-.04,.41]},o.a.createElement("mesh",{onClick:function(){}},o.a.createElement("sphereBufferGeometry",{args:[4,32,32]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3,color:"#bababa"}))),o.a.createElement("group",{position:[0,7,1],"rotation-x":-.25*Math.PI},o.a.createElement(w.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"Click to start")))}function M(){return o.a.createElement("group",null,o.a.createElement(a.Suspense,{fallback:null},o.a.createElement("group",{"position-y":3},o.a.createElement(A,null))))}function z(){D.makeKeyReactive("cursorMode");var e=Object(a.useRef)();return Object(v.b)((function(){e.current&&e.current.position.lerp(D.cursorAt,.5)})),o.a.createElement("group",{visible:!("ontouchstart"in window),ref:e},"addCodeBlock"===D.cursorMode&&o.a.createElement("group",null,o.a.createElement("mesh",{"position-y":1,"rotation-x":1*Math.PI},o.a.createElement("coneBufferGeometry",{args:[.8,2,32,1]}),o.a.createElement("meshStandardMaterial",{color:"#bababa",roughness:.3,metalness:1})),o.a.createElement("group",{"rotation-x":-.25*Math.PI,"position-y":3},o.a.createElement(w.a,{color:"#000000",fontSize:.7,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.04,outlineColor:"#ffffff"},"Click to add"))))}var B=function(e){var t=e.a,a=e.b,o=e.dotted,r=void 0!==o&&o,i=n(33).LineSegmentsGeometry,c=n(49).LineGeometry,l=(new y.Vector3).copy(t).distanceTo(a)/1.6;l>500&&(l=500);var u=new y.CatmullRomCurve3([new y.Vector3(t.x,t.y-1,t.z),new y.Vector3(t.x,t.y-1+l,t.z),new y.Vector3(a.x,a.y-1+l,a.z),new y.Vector3(a.x,a.y-1,a.z)],!1),s=new c;r&&(s=new i);for(var d=[],f=[],p=new y.Vector3,m=new y.Color,g=new y.Color("#0000ff"),v=0;v<100;v++)u.getPointAt(v/100%1,p),isNaN(p.x)&&(p.x=0),isNaN(p.y)&&(p.y=0),isNaN(p.z)&&(p.z=0),f.push(p.x,p.y,p.z),m.setStyle("#00ff00"),m.lerp(g,v/100),m.offsetHSL(0,.5,0),d.push(m.r,m.g,m.b);return s.setColors(d),s.setPositions(f),s};function K(){D.makeKeyReactive("draggingIOID");var e=n(32).LineMaterial,t=n(58).Line2,r=Object(a.useMemo)((function(){return new e({transparent:!0,color:new y.Color("#00ffff"),linewidth:.0015,opacity:1,dashed:!0,vertexColors:!1})}),[]),i=Object(a.useRef)({}),c=Object(a.useMemo)((function(){var e=(new y.Vector3).copy(D.cursorAt);e.set(1,1,1);var n=new y.Vector3(1,1,1).copy(D.dragStartPos),a=B({a:e,b:n,dotted:!0}),o=new t(a,r);o.computeLineDistances();var c=!1;return i.current.updateLine=function(){if(!D.isDown||e.x===D.cursorAt.x&&e.y===D.cursorAt.y&&e.z===D.cursorAt.z||(c=!0),e.copy(D.cursorAt),c){var t=B({a:e,b:n,dotted:!0});o.geometry=t}},o}));return Object(v.b)((function(){Object.values(i.current).forEach((function(e){return e()}))})),o.a.createElement("group",null,D.draggingIOID&&o.a.createElement("primitive",{object:c}))}function V(e){var t=e.link,r=n(32).LineMaterial,i=n(58).Line2,c=Object(a.useMemo)((function(){return new r({transparent:!0,color:new y.Color("#00ffff"),linewidth:.0015,opacity:.8,dashed:!0,vertexColors:!0})}),[]),l=Object(a.useRef)({}),u=Object(v.c)().scene,s=Object(a.useMemo)((function(){var e=new y.Vector3,t=new y.Vector3,n=B({a:e,b:t}),a=new i(n,c);return a.computeLineDistances(),a}),[]);return Object(a.useEffect)((function(){var e=new y.Vector3,n=new y.Vector3,a=0;l.current.updateLine=function(){var o=u.getObjectByName(t.data.input._id),r=u.getObjectByName(t.data.output._id);if(o&&r&&(o.getWorldPosition(e),r.getWorldPosition(n),a!==e.length()+n.length())){a=e.length()+n.length();var i=B({a:e,b:n});s.geometry=i}}}),[]),Object(v.b)((function(){Object.values(l.current).forEach((function(e){return e()}))})),o.a.createElement("group",null,o.a.createElement("primitive",{object:s}))}var T=function(e){var t=e.idx,n=e.io,a=void 0===n?"input":n,r=e.node,i=e.socket,c=e.e,l=e.total,s=new y.Vector3,d=new y.Vector3,f=c*-Math.PI;"output"===a&&(f=Math.PI*c),f-=2*Math.PI*.5/l,f+=1.5*Math.PI,s.setFromCylindricalCoords(6,f,0),d.setFromCylindricalCoords(10.5,f,0);return o.a.createElement("group",null,o.a.createElement("mesh",{"position-y":0,name:i._id,onPointerDown:function(e){e.stopPropagation(),e.target.setPointerCapture(e.pointerId),D.isDown=!0,D.draggingIOID={socket:JSON.parse(JSON.stringify(i)),node:JSON.parse(JSON.stringify(r))},D.dragStartPos.copy(D.cursorAt)},onPointerMove:function(e){var t=e.eventObject;t.material.emissive=new y.Color("#323232"),t.material.needsUpdate=!0},onPointerEnter:function(e){var t=e.eventObject;t.material.emissive=new y.Color("#323232"),t.material.needsUpdate=!0},onPointerLeave:function(e){var t=e.eventObject;t.material.emissive=new y.Color("#000000"),t.material.needsUpdate=!0},onPointerUp:function(e){e.stopPropagation(),e.target.releasePointerCapture(e.pointerId);var t=function(){if(D.draggingIOID&&D.draggingIOID.socket._id!==i._id&&D.draggingIOID.node._fid!==r._fid&&D.draggingIOID.socket.type!==i.type){var e=[{node:r,socket:i},Object(u.a)({},D.draggingIOID)],t=e.find((function(e){return"input"===e.socket.type})),n=e.find((function(e){return"output"===e.socket.type}));if(console.log(t,n),t&&n)return{input:t,output:n}}}();t&&N.addLink({input:t.input.socket,output:t.output.socket}),D.isDown=!1,D.draggingIOID=!1},position:s.toArray(),userData:i},o.a.createElement("sphereBufferGeometry",{args:[1,20,20]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3,color:"input"===a?"green":"blue"})),o.a.createElement("group",{position:d.toArray()},o.a.createElement("group",{"position-z":"input"===a?-.1:.1,"rotation-x":-.25*Math.PI},o.a.createElement(w.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"".concat(t)))))};function G(e){var t=e.node,n=Object(a.useRef)();return Object(v.b)((function(){n.current&&(D.draggingNodeID===t.data._id&&(t.data.position=D.cursorAt.toArray()),n.current.position.fromArray(t.data.position))})),o.a.createElement("group",{"position-y":2.75},o.a.createElement("group",{ref:n},o.a.createElement("group",{"position-z":18,"position-y":0,"rotation-x":-.25*Math.PI},o.a.createElement(w.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"".concat(t.data.title))),o.a.createElement("group",null,o.a.createElement("mesh",{raycast:E.a,onPointerDown:function(e){D.isDown=!0,D.draggingNodeID=t.data._id,D.moved=0},onPointerUp:function(e){D.isDown=!1,D.draggingNodeID=!1,N.saveCodeBlock({node:t}),D.moved<=10&&(D.currentEditNodeID=t._fid,D.overlay="node"),D.moved=0}},o.a.createElement("sphereBufferGeometry",{args:[2.75,32,32]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3}))),o.a.createElement("group",{"position-z":-1.11},t.data.inputs.map((function(e,n,a){return o.a.createElement(T,{key:e._id,socket:e,node:t,idx:n,e:(n+0)/a.length,total:t.data.inputs.length+t.data.outputs.length})}))),o.a.createElement("group",{"position-z":1.11},t.data.outputs.map((function(e,n,a){return o.a.createElement(T,{io:"output",key:e._id,socket:e,node:t,idx:n,e:(n+1)/a.length,total:t.data.inputs.length+t.data.outputs.length})})))))}function U(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],r=t[1];D.makeKeyReactive("canvasOwnerID"),D.makeKeyReactive("canvasID");var i=D.canvasID,c=D.canvasOwnerID;return Object(a.useEffect)((function(){if(!i)return function(){};if(!c)return function(){};var e=S.database().ref("/canvas/".concat(i,"/").concat(c,"/nodes")).on("value",(function(e){if(e){var t=[],n=e.val();for(var a in n)t.push({_fid:a,data:n[a]});D.nodes=t,r(t)}}));return function(){e()}}),[i,c]),o.a.createElement("group",null,n.map((function(e){return o.a.createElement(G,{key:e._fid,node:e})})))}function F(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],r=t[1];D.makeKeyReactive("canvasOwnerID"),D.makeKeyReactive("canvasID");var i=D.canvasID,c=D.canvasOwnerID;return Object(a.useEffect)((function(){return i&&c?S.database().ref("/canvas/".concat(i,"/").concat(c,"/connections")).on("value",(function(e){if(e){var t=[],n=e.val();for(var a in n)t.push({_fid:a,data:n[a]});D.connections=t,r(t)}})):function(){}}),[i,c]),o.a.createElement("group",null,n.map((function(e){return o.a.createElement(V,{key:e._fid,link:e})})))}function W(){var e=Object(v.c)().get;return o.a.createElement(x.a,{near:.1,frames:1,resolution:128,far:1e3},(function(t){e().scene.background=new y.Color("#444"),e().scene.environment=t}))}function H(){return o.a.createElement("group",null,o.a.createElement(_,null),o.a.createElement(M,null),o.a.createElement(U,null),o.a.createElement(F,null),o.a.createElement(z,null),o.a.createElement(K,null),o.a.createElement(W,null),o.a.createElement("ambientLight",{intensity:.87}),o.a.createElement("directionalLight",{position:[10,10,0],intensity:.87}),o.a.createElement("ambientLight",{position:[10,10,-10],intensity:.87}))}function X(e){var t,n,o=e.resize,r=e.setOKSize,i=Object(v.c)();return Object(a.useEffect)((function(){o.current&&(o.current.style.width="".concat(window.innerWidth,"px"),o.current.style.height="".concat(window.innerHeight,"px")),setTimeout((function(){r(!0)}))}),[i,null===i||void 0===i||null===(t=i.size)||void 0===t?void 0:t.width,null===i||void 0===i||null===(n=i.size)||void 0===n?void 0:n.height,o.current]),null}function Y(e){var t=e.done,n=e.firebaseConfig;return o.a.createElement("div",{style:{width:"".concat(window.innerWidth,"px"),height:"".concat(window.innerHeight,"px"),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}},o.a.createElement(J,{firebaseConfig:n,done:t}))}function J(e){var t=e.done,n=e.firebaseConfig;return Object(a.useEffect)((function(){return k({firebaseConfig:n}),S.auth().onAuthStateChanged((function(e){e&&t(e)}))}),[]),o.a.createElement("button",{style:{cursor:"pointer",backgroundColor:"rgba(50,50,255,1.0)",color:"white",borderRadius:"50px",padding:"20px 25px",appearance:"none",border:"none",fontSize:"20px"},className:" cursor-pointer bg-blue-500 text-white rounded-full px-6 py-3",onClick:function(){!function(){var e=new b.a.auth.GoogleAuthProvider;b.a.auth().signInWithPopup(e)}()}},"Login With Google")}function Q(e){var t=e.firebaseConfig,n=e.children,r=e.canvasID,i=void 0!==r&&r,c=Object(a.useState)("ready"),l=Object(g.a)(c,2),u=l[0],s=l[1];return Object(a.useEffect)((function(){var e=[];k({firebaseConfig:t});var n=S.auth().onAuthStateChanged((function(e){i&&e?S.database().ref("/profile/".concat(e.uid,"/canvas/").concat(i)).once("value",(function(t){var n=t.val();n&&n.ownerID===e.uid||n.shareACL[e.uid]?s("show"):s("noRights")})):s(e?"show":"needsLogin")}));return e.push(n),function(){e.forEach((function(e){return e()}))}}),[]),o.a.createElement("span",null,"show"===u&&n,"loading"===u&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"Loading"),"needsLogin"===u&&o.a.createElement(Y,{done:function(){s("show")},firebaseConfig:t}),"noRights"===u&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"No Access Rights."))}var Z=function(e){var t=e.canvasID,n=e.ownerID,a=e.codes,r=void 0===a?[]:a,i=e.firebaseConfig;return o.a.createElement(Q,{firebaseConfig:i,canvasID:t},o.a.createElement(q,{firebaseConfig:i,canvasID:t,ownerID:n,codes:r}))},q=function(e){var t=e.canvasID,n=e.ownerID,r=e.codes,i=void 0===r?[]:r,c=e.firebaseConfig,l=Object(a.useState)(!1),u=Object(g.a)(l,2),s=u[0],d=u[1],f=Object(a.useState)(!1),p=Object(g.a)(f,2),m=p[0],y=p[1];Object(a.useEffect)((function(){D.canvasID=t,D.canvasOwnerID=n,D.firebaseConfig=c,function(e){return new Promise((function(t){var n=setInterval((function(){var a=D[e];a&&(clearInterval(n),t(a))}))}))}("firebaseConfig").then((function(e){k({firebaseConfig:e}),d(!0)}))}),[t,n]);var b=Object(a.useRef)();return o.a.createElement("div",{ref:b,style:{width:"100%",height:"100%",position:"relative"}},o.a.createElement(v.a,{dpr:"undefined"!==typeof window&&window.devicePixelRatio||1},o.a.createElement(X,{setOKSize:y,resize:b}),s&&m&&o.a.createElement(H,null)),s&&m&&o.a.createElement(L,{codes:i}),s&&o.a.createElement("div",{style:{position:"absolute",top:"0px",right:"0px",zIndex:"1000"}},o.a.createElement("div",{style:{margin:"12px",padding:"12px 25px",boxShadow:"0px 0px 20px 0px #bababa",background:"white",cursor:"pointer",borderRadius:"50px"},onClick:function(){j()}},"Logout")))};function $(e){var t=e.firebaseConfig,n=e.children,r=Object(a.useState)("ready"),i=Object(g.a)(r,2),c=i[0],l=i[1];return Object(a.useEffect)((function(){var e=[];k({firebaseConfig:t});var n=S.auth().onAuthStateChanged((function(e){l(e?"show":"needsLogin")}));return e.push(n),function(){e.forEach((function(e){return e()}))}}),[]),o.a.createElement("span",null,"show"===c&&n,"loading"===c&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"Loading"),"needsLogin"===c&&o.a.createElement(Y,{done:function(){l("show")},firebaseConfig:t}),"noRights"===c&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"No Access Rights."))}function ee(e){var t=e.firebaseConfig,n=Object(a.useState)("New Logic Graph"),r=Object(g.a)(n,2),i=r[0],c=r[1];return o.a.createElement("div",{style:{padding:"15px",display:"flex",justifyContent:"start",alignItems:"center"}},o.a.createElement("textarea",{rows:1,style:{padding:"15px",margin:"0px"},value:i,onInput:function(e){c(e.target.value)},onChange:function(e){c(e.target.value)}}),o.a.createElement("button",{style:{padding:"15px",margin:"0px"},onClick:function(){O({firebaseConfig:t}).then((function(e){var t=e.db,n=e.user;t.ref("profile/".concat(n.uid,"/canvas")).push().set({title:i,ownerID:n.uid,shareACL:{placeholder:!1}}),D.listingReload++}))}},"Add Logic Graph"))}var te={"text/plain":"Text","text/html":"Url",default:"Text"};var ne=function(e,t){var n,a,o,r,i,c,l=!1;t||(t={}),n=t.debug||!1;try{if(o=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),r=document.createRange(),i=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),"undefined"===typeof a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var o=te[t.format]||te.default;window.clipboardData.setData(o,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(c),r.selectNodeContents(c),i.addRange(r),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(u){n&&console.error("unable to copy using execCommand: ",u),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(u){n&&console.error("unable to copy using clipboardData: ",u),n&&console.error("falling back to prompt"),a=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(a,e)}}finally{i&&("function"==typeof i.removeRange?i.removeRange(r):i.removeAllRanges()),c&&document.body.removeChild(c),o()}return l};function ae(e){var t=e.firebaseConfig,n=e.onEdit,r=void 0===n?function(){}:n;return D.makeKeyReactive("listing"),D.makeKeyReactive("listingReload"),Object(a.useEffect)((function(){O({firebaseConfig:t}).then((function(e){var t=e.user,n=e.db.ref("profile/".concat(t.uid,"/canvas")),a=function(){n.once("value",(function(e){var t=e.val();if(t){var n=[];for(var a in t)n.push({_fid:a,data:t[a]});D.listing=n}}))};a(),D.onChange("listingReload",(function(){a()}))}))}),[D.listingReload]),o.a.createElement("div",{style:{overflowX:"scroll",marginLeft:"12px"}},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"p-3 border  ",colSpan:1},o.a.createElement("span",{className:"w-24 inline-block"}),"Title"," ",o.a.createElement("span",{className:"w-24 inline-block"})),o.a.createElement("th",{className:"p-3 border  ",colSpan:1},o.a.createElement("span",{className:"w-3 inline-block"}),"CanvasID"," ",o.a.createElement("span",{className:"w-3 inline-block"})),o.a.createElement("th",{className:"p-3 border ",colSpan:3},"Actions"))),o.a.createElement("tbody",null,D.listing.map((function(e,n){return o.a.createElement("tr",{key:e._fid},o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 m-3 border bg-white "},e.data.title),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 m-3 border bg-white "},o.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){ne(e._fid)}},e._fid)),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},onClick:function(){ne("\n/* graphTitle: ".concat(e.data.title," */\n/* graphID: ").concat(e._fid," */\n").trim())}},"Copy Code")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},className:" p-3 px-6 rounded-full bg-yellow-500 text-white",onClick:function(){var n=e.data.title||"no title";O({firebaseConfig:t}).then((function(t){var a=t.user,o=t.db,r=window.prompt('Type "'.concat(n,'" to Confirm Removal, theres no restore.'),"".concat(n));r&&(r=(r||"").trim(),o.ref("profile/".concat(a.uid,"/canvas/").concat(e._fid,"/title")).set(r),e.data.title=r,D.listingReload++)}))}},"Rename")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},className:" p-3 px-6 rounded-full bg-blue-500 text-white",onClick:function(){r({ownerID:e.data.ownerID,canvasID:e._fid})}},"Edit")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border"},o.a.createElement("button",{style:{cursor:"pointer"},className:"  p-3 px-6 rounded-full bg-red-500 text-white",onClick:function(){O({firebaseConfig:t}).then((function(t){var a=t.user,o=t.db,r=e.data.title||"no title";(window.prompt('Type "'.concat(r,'" to Confirm Removal, theres no restore.'),"".concat(r," ______"))||"").trim()===r&&(o.ref("profile/".concat(a.uid,"/canvas/").concat(e._fid)).remove(),D.listing.splice(n,1),D.listingReload++)}))}},"Remove")))})))))}function oe(e){var t=e.firebaseConfig,n=e.onEdit,a=void 0===n?function(){}:n;return o.a.createElement("div",{style:{width:"100%",backgroundColor:"white"}},o.a.createElement("div",{style:{width:"100%",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.92)"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"35px",fontFamily:"Arial"}},o.a.createElement("div",null,"Project Listing"))),o.a.createElement(ee,{firebaseConfig:t}),o.a.createElement(ae,{firebaseConfig:t,onEdit:a})))}var re=function(e){var t=e.firebaseConfig;return o.a.createElement($,{firebaseConfig:t},o.a.createElement(oe,{firebaseConfig:t,onEdit:function(e){console.log(e)}}))},ie=function(e){var t=e.firebaseConfig,n=e.codes,r=void 0===n?[]:n,i=Object(a.useState)(!1),c=Object(g.a)(i,2),l=c[0],u=c[1];return o.a.createElement($,{firebaseConfig:t},!l&&o.a.createElement(oe,{firebaseConfig:t,onEdit:function(e){u({ownerID:e.ownerID,canvasID:e.canvasID})}}),l&&o.a.createElement(Z,{firebaseConfig:t,canvasID:l.canvasID,ownerID:l.ownerID,codes:r}),l&&o.a.createElement("div",{style:{position:"absolute",top:"60px",right:"0px",zIndex:"1000"}},o.a.createElement("div",{style:{margin:"12px",padding:"12px 25px",background:"white",boxShadow:"0px 0px 20px 0px #bababa",cursor:"pointer",borderRadius:"50px"},onClick:function(){u(!1)}},"Back")),!l&&o.a.createElement("div",{style:{position:"absolute",top:"0px",right:"0px",zIndex:"1000"}},o.a.createElement("div",{style:{margin:"12px",padding:"12px 25px",background:"white",cursor:"pointer",boxShadow:"0px 0px 20px 0px #bababa",borderRadius:"50px"},onClick:function(){j()}},"Logout")))};function ce(){return o.a.createElement(ie,{firebaseConfig:le,codes:ue()})}var le={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},ue=function(){var e=n(55);return function(t){var n=[];return t.keys().forEach((function(a){var o=e.basename(a);n.push({title:o,loader:function(){return t(a)}})})),n}(n(56))},se=function(){return o.a.createElement(Z,{firebaseConfig:de,canvasID:"-MdBQtfGPXXPkl-NuEoW",ownerID:"NGpUixuU0NOkOlmLsLuepkaZxxt1",codes:fe()})},de={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},fe=function(){var e=n(55);return function(t){var n=[];return t.keys().forEach((function(a){var o=e.basename(a);n.push({title:o,loader:function(){return t(a)}})})),n}(n(56))},pe=function(){return o.a.createElement(re,{firebaseConfig:me})},me={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},ge=function(){return o.a.createElement(c.a,null,o.a.createElement(l.c,null,o.a.createElement(l.a,{path:"/project"},o.a.createElement(se,null)),o.a.createElement(l.a,{path:"/listing"},o.a.createElement(pe,null)),o.a.createElement(l.a,{path:"/"},o.a.createElement(ce,null))))};i.a.render(o.a.createElement(ge,null),document.getElementById("root"))}},[[65,2,3]]]);
//# sourceMappingURL=main.2c493d84.chunk.js.map