(this["webpackJsonp@effectnode/cms-example"]=this["webpackJsonp@effectnode/cms-example"]||[]).push([[1],{57:function(e,t,n){var a={"./lok.myFristNode.js":[86,0,5],"./lok.mySecondNode.js":[87,0,4,6]};function o(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(o)}))}o.keys=function(){return Object.keys(a)},o.id=57,e.exports=o},66:function(e,t,n){e.exports=n(85)},67:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);n(67);var a=n(0),o=n.n(a),r=n(60),i=n.n(r),c=n(63),s=n(15),u=n(25),l=n(11),d=n(2),f=n(4),p=n(19),m=n.n(p),v=n(27),g=n(13),h=n(17),b=n(3),y=n(31),E=(n(73),n(75),n(92)),w=n(90),x=n(91),I=n(50),C=n.n(I),D=function(){return"_"+Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9)},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=D(),n={exportJSON:function(){return JSON.parse(JSON.stringify(e))},getNameSpcaeID:function(){return t},onChange:function(n,a){var o="".concat(t),r=function(){a(e[n])};return window.addEventListener("".concat(o,"-").concat(n),r),function(){window.removeEventListener("".concat(o,"-").concat(n),r)}},useReactiveKey:function(n,o){Object(a.useEffect)((function(){var a="".concat(t),r=function(){o(e[n])};return window.addEventListener("".concat(a,"-").concat(n),r),function(){window.removeEventListener("".concat(a,"-").concat(n),r)}}),[])},makeKeyReactive:function(e){var n=Object(a.useState)(0),o=Object(g.a)(n,2),r=o[0],i=o[1];Object(a.useEffect)((function(){var n="".concat(t),a=function(){i((function(e){return e+1}))};return window.addEventListener("".concat(n,"-").concat(e),a),function(){window.removeEventListener("".concat(n,"-").concat(e),a)}}),[r])},onChangeAny:function(n){var a="".concat(t),o=function(){n(e[key])};return window.addEventListener("".concat(a),o),function(){window.removeEventListener("".concat(a),o)}},notifyKeyChange:function(e){window.dispatchEvent(new CustomEvent("".concat(t,"-").concat(e),{detail:{}}))}},o=new Proxy(e,{get:function(e,t){return n[t]?n[t]:e[t]},set:function(e,n,a){return e[n]=a,"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("".concat(t,"-").concat(n),{detail:{}})),!0}});return o}({listing:[],listingReload:0,layouts:[],layoutsReload:0,canvasID:!1,canvasOwnerID:!1,overlay:"",cursorMode:"ready",hovering:"floor",draggingNodeID:!1,draggingIOID:!1,addNodeTitle:"mytitle",cursorAt:new b.Vector3,dragStartPos:new b.Vector3,moved:0,isDown:!1,nodes:[],connections:[],currentEditSocketID:!1,currentEditNodeID:!1,firebaseConfig:!1}),O=new Map;function j(e){var t=e.firebaseConfig;return O.has("app")||O.set("app",y.a.initializeApp(t)),O.has("database")||O.set("database",y.a.database()),O.has("setup-listen-login")||(O.set("setup-listen-login",!0),O.get("app").auth().onAuthStateChanged((function(e){e?O.set("user",e):O.delete("user")}))),O.has("setup-do-login")||(O.set("setup-do-login",!0),console.log("[Firebase]: done setup")),O.get("app")}var S=function(e){var t=e.firebaseConfig;return new Promise((function(e){j({firebaseConfig:t});var n=setInterval((function(){O.has("user")&&(clearInterval(n),e({user:O.get("user"),db:O.get("database")}))}))}))},L=function(){var e=Object(v.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y.a.auth().signOut());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=y.a,R=function(){function e(){Object(d.a)(this,e)}return Object(f.a)(e,null,[{key:"addCodeBlock",value:function(e){var t=e.point;k.overlay="",k.cursorMode="ready",k.hovering="floor";var n=N.database().ref("/canvas/".concat(k.canvasID,"/").concat(k.canvasOwnerID,"/nodes")).push(),a=D();n.set({title:k.addNodeTitle,_id:a,position:t.toArray(),inputs:[{_id:D(),type:"input",nodeID:a},{_id:D(),type:"input",nodeID:a},{_id:D(),type:"input",nodeID:a},{_id:D(),type:"input",nodeID:a},{_id:D(),type:"input",nodeID:a}],outputs:[{_id:D(),type:"output",nodeID:a},{_id:D(),type:"output",nodeID:a},{_id:D(),type:"output",nodeID:a},{_id:D(),type:"output",nodeID:a},{_id:D(),type:"output",nodeID:a}]})}},{key:"saveCodeBlock",value:function(e){var t=e.node;N.database().ref("/canvas/".concat(k.canvasID,"/").concat(k.canvasOwnerID,"/nodes/").concat(t._fid)).set(t.data)}},{key:"removeCodeBlockByID",value:function(e){var t=e.nodeID;N.database().ref("/canvas/".concat(k.canvasID,"/").concat(k.canvasOwnerID,"/nodes/").concat(t)).remove()}},{key:"addLink",value:function(e){var t=e.input,n=e.output;N.database().ref("/canvas/".concat(k.canvasID,"/").concat(k.canvasOwnerID,"/connections")).push().set({_id:D(),input:t,output:n})}},{key:"removeLinkByID",value:function(e){var t=e.linkID;N.database().ref("/canvas/".concat(k.canvasID,"/").concat(k.canvasOwnerID,"/connections/").concat(t)).remove()}},{key:"removeCurrentNodeAndConnections",value:function(){var t=k.currentEditNodeID,n=k.nodes.find((function(e){return e._fid===t}));if(n){var a=n.data._id;k.connections.filter((function(e){return e.data.input.nodeID===a||(e.data.output.nodeID===a||void 0)})).map((function(e){return e._fid})).forEach((function(t){e.removeLinkByID({linkID:t})})),e.removeCodeBlockByID({nodeID:t}),k.currentEditNodeID=!1}}}]),e}();function P(e){var t=e.codes,n=void 0===t?[]:t;return k.makeKeyReactive("overlay"),Object(a.useEffect)((function(){var e=function(e){"escape"===e.key.toLowerCase()&&(k.overlay="")};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}})),k.overlay?o.a.createElement("div",{style:{position:"fixed",zIndex:"20",top:"0px",left:"0px",width:"100%",backgroundColor:"rgba(255,255,255,0.92)"}},"main"===k.overlay&&o.a.createElement(_,{codes:n}),"node"===k.overlay&&o.a.createElement(M,{codes:n}),"addCodeBlock"===k.overlay&&o.a.createElement("div",{style:{width:"100%",position:"absolute",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.95)"}},o.a.createElement("div",{style:{width:"100%",backgroundColor:"rgba(40,255,40,1.0)"},className:"bg-green-400"},o.a.createElement("div",{style:{width:"100%",padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",{style:{width:"100%"}},"Click on Floor to Add")))),k.overlay&&o.a.createElement("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:10}},o.a.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",fill:"black",onClick:function(){k.overlay=""},onPointerDown:function(){k.overlay=""},style:{cursor:"pointer"}},o.a.createElement("path",{d:"M12 11.293l10.293-10.293.707.707-10.293 10.293 10.293 10.293-.707.707-10.293-10.293-10.293 10.293-.707-.707 10.293-10.293-10.293-10.293.707-.707 10.293 10.293z"})))):o.a.createElement("div",null)}function _(e){var t=e.codes,n=void 0===t?[]:t;return o.a.createElement("div",{style:{width:"100%",height:"100%",position:"fixed",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.92)"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",null,"Getting Started"))),o.a.createElement("div",{style:{padding:"15px",fontSize:"20px",fontFamily:"Arial"}},o.a.createElement("div",null,"Add New CodeBlock")),n.map((function(e){return o.a.createElement("div",{key:e.title,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(){k.addNodeTitle=e.title,k.hovering="floor",k.cursorMode="addCodeBlock",k.overlay="addCodeBlock"}},e.title))})))}function M(e){var t=e.codes,n=void 0===t?[]:t,r=Object(a.useMemo)((function(){var e=k.currentEditNodeID,t=k.nodes.find((function(t){return t._fid===e})),n=[],a=[];if(t){var o=t.data._id;n=k.connections.filter((function(e){if(e.data.input.nodeID===o)return!0})),a=k.connections.filter((function(e){if(e.data.output.nodeID===o)return!0}))}return{node:t,inputLinks:n,outputLinks:a}})),i=r.node,c=r.outputLinks,s=r.inputLinks,u=Object(a.useState)(0),l=Object(g.a)(u,2)[1],d=Object(a.useState)(i.data.title),f=Object(g.a)(d,2),p=f[0],m=f[1];return o.a.createElement("div",{style:{width:"100%",height:"100%",position:"fixed",top:"0px",left:"0px",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"lightblue"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"30px",fontFamily:"Arial"}},o.a.createElement("div",null,"Node Settings"))),o.a.createElement("div",{style:{padding:"15px",fontSize:"20px",fontFamily:"Arial"}},o.a.createElement("div",null,"Node using logic:"," ",o.a.createElement("div",{style:{borderColor:"black",display:"inline-block",border:"black solid 1px"}},o.a.createElement("select",{style:{appearance:"none",width:"100%",height:"100%"},value:p,onChange:function(e){var t=e.target.value;i.data.title=t,R.saveCodeBlock({node:i}),m(t)}},n.map((function(e,t){return o.a.createElement("option",{key:t+e.title,value:e.title},e.title)})))))),s.length>0&&o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Inputs")),s.map((function(e){var t=e.data.input._id,n=i.data.inputs.findIndex((function(e){return e._id===t})),a=i.data.inputs.find((function(e){return e._id===t})),r=k.nodes.find((function(e){return e.data._id===a.nodeID}));return o.a.createElement("div",{key:e._fid,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(t){"red"===t.currentTarget.style.color&&(R.removeLinkByID({linkID:e._fid}),l((function(e){return e+1}))),t.currentTarget.style.color="red"}},'Remove Input at label "',n,'"'," ",r.data.title&&o.a.createElement("span",null,'which is conncted to "',r.data.title,'"')))})),c.length>0&&o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Outputs")),c.map((function(e){var t=e.data.output._id,n=i.data.outputs.findIndex((function(e){return e._id===t})),a=i.data.outputs.find((function(e){return e._id===t})),r=k.nodes.find((function(e){return e.data._id===a.nodeID}));return o.a.createElement("div",{key:e._fid,style:{marginLeft:"15px",marginBottom:"15px",textDecoration:"underline"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(t){"red"===t.currentTarget.style.color&&(R.removeLinkByID({linkID:e._fid}),l((function(e){return e+1}))),t.currentTarget.style.color="red"}},'Remove Output at label "',n,'"'," ",r.data.title&&o.a.createElement("span",null,'which is conncted to "',r.data.title,'"')))})),o.a.createElement("div",{style:{padding:"15px",fontSize:"23px",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"}},"Remove Node & Connections")),o.a.createElement("div",{style:{padding:"15px",textDecoration:"underline",fontFamily:"Arial"}},o.a.createElement("div",{style:{cursor:"pointer"},onPointerDown:function(){window.confirm("remove item")&&(R.removeCurrentNodeAndConnections(),k.overlay="")}},"Remove")))}function A(){var e=Object(h.c)().camera,t=Object(a.useRef)();Object(a.useEffect)((function(){e.position.X=0,e.position.y=50,e.position.z=75,e.fov=45,e.lookAt(0,0,0),e.near=.1,e.far=1e4,e.updateProjectionMatrix()}),[t.current]);var n=function(){"floor"===k.hovering?"ready"===k.cursorMode?document.body.style.cursor="grab":"pan"===k.cursorMode?document.body.style.cursor="grabbing":"addCodeBlock"===k.cursorMode&&(document.body.style.cursor="crosshair"):"object"===k.hovering?document.body.style.cursor="pointer":(k.hovering,document.body.style.cursor="")};k.useReactiveKey("overlay",n),k.useReactiveKey("cursorMode",n),k.useReactiveKey("hovering",n),k.useReactiveKey("draggingNodeID",(function(){t.current.enabled=!k.draggingNodeID})),k.useReactiveKey("draggingIOID",(function(){t.current.enabled=!k.draggingIOID}));var r={onPointerDown:function(e){var t=e.point;k.isDown=!0,"ready"===k.cursorMode&&(k.cursorMode="pan"),"addCodeBlock"===k.cursorMode&&R.addCodeBlock({point:t})},onPointerUp:function(e){e.point;k.isDown=!1,"pan"===k.cursorMode&&(k.cursorMode="ready"),setTimeout((function(){k.draggingIOID&&(k.draggingIOID=!1)}),100)},onPointerEnter:function(){},onPointerMove:function(e){k.moved++,e.stopPropagation(),"floor"!==k.hovering&&(k.hovering="floor"),k.cursorAt.copy(e.point)}};return Object(a.useEffect)((function(){window.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),window.addEventListener("touchmove",(function(e){e.preventDefault()}),{passive:!1})}),[]),o.a.createElement("group",null,o.a.createElement(E.a,{screenSpacePanning:!1,ref:t}),o.a.createElement("mesh",Object.assign({visible:!1,name:"floor","rotation-x":-.5*Math.PI},r),o.a.createElement("planeBufferGeometry",{args:[1e3,1e3,2,2]}),o.a.createElement("shaderMaterial",{fragmentShader:"void main (void) { discard; }"})),o.a.createElement("gridHelper",{raycast:function(){},"position-y":.01,args:[1e3,100,"#232323","#232323"]}))}function z(e){var t=Object.assign({},e),n=Object(a.useRef)();return Object(h.b)((function(e){var t=e.clock.getElapsedTime();n.current.rotation.z=b.MathUtils.lerp(n.current.rotation.z,Math.sin(t/4)/20,.1),n.current.position.y=b.MathUtils.lerp(n.current.position.y,(-5+Math.sin(t))/5,.1)})),o.a.createElement("group",Object.assign({raycast:w.a,onPointerEnter:function(){k.hovering="object"},onPointerLeave:function(){k.hovering="floor"},onPointerDown:function(e){e.stopPropagation(),e.target.setPointerCapture(e.pointerId)},onPointerUp:function(e){k.overlay="main",k.hovering="overlay",e.stopPropagation(),e.target.releasePointerCapture(e.pointerId)},ref:n},t),o.a.createElement("pointLight",{"position-x":0,"position-z":-2,"position-y":2}),o.a.createElement("group",{"rotation-x":0*Math.PI,position:[0,-.04,.41]},o.a.createElement("mesh",{onClick:function(){}},o.a.createElement("sphereBufferGeometry",{args:[4,32,32]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3,color:"#bababa"}))),o.a.createElement("group",{position:[0,7,1],"rotation-x":-.25*Math.PI},o.a.createElement(x.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"Click to start")))}function B(){return o.a.createElement("group",null,o.a.createElement(a.Suspense,{fallback:null},o.a.createElement("group",{"position-y":3},o.a.createElement(z,null))))}function K(){k.makeKeyReactive("cursorMode");var e=Object(a.useRef)();return Object(h.b)((function(){e.current&&e.current.position.lerp(k.cursorAt,.5)})),o.a.createElement("group",{visible:!("ontouchstart"in window),ref:e},"addCodeBlock"===k.cursorMode&&o.a.createElement("group",null,o.a.createElement("mesh",{"position-y":1,"rotation-x":1*Math.PI},o.a.createElement("coneBufferGeometry",{args:[.8,2,32,1]}),o.a.createElement("meshStandardMaterial",{color:"#bababa",roughness:.3,metalness:1})),o.a.createElement("group",{"rotation-x":-.25*Math.PI,"position-y":3},o.a.createElement(x.a,{color:"#000000",fontSize:.7,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.04,outlineColor:"#ffffff"},"Click to add"))))}var V=function(e){var t=e.a,a=e.b,o=e.dotted,r=void 0!==o&&o,i=n(33).LineSegmentsGeometry,c=n(49).LineGeometry,s=(new b.Vector3).copy(t).distanceTo(a)/1.6;s>500&&(s=500);var u=new b.CatmullRomCurve3([new b.Vector3(t.x,t.y-1,t.z),new b.Vector3(t.x,t.y-1+s,t.z),new b.Vector3(a.x,a.y-1+s,a.z),new b.Vector3(a.x,a.y-1,a.z)],!1),l=new c;r&&(l=new i);for(var d=[],f=[],p=new b.Vector3,m=new b.Color,v=new b.Color("#0000ff"),g=0;g<100;g++)u.getPointAt(g/100%1,p),isNaN(p.x)&&(p.x=0),isNaN(p.y)&&(p.y=0),isNaN(p.z)&&(p.z=0),f.push(p.x,p.y,p.z),m.setStyle("#00ff00"),m.lerp(v,g/100),m.offsetHSL(0,.5,0),d.push(m.r,m.g,m.b);return l.setColors(d),l.setPositions(f),l};function G(){k.makeKeyReactive("draggingIOID");var e=n(32).LineMaterial,t=n(59).Line2,r=Object(a.useMemo)((function(){return new e({transparent:!0,color:new b.Color("#00ffff"),linewidth:.0015,opacity:1,dashed:!0,vertexColors:!1})}),[]),i=Object(a.useRef)({}),c=Object(a.useMemo)((function(){var e=(new b.Vector3).copy(k.cursorAt);e.set(1,1,1);var n=new b.Vector3(1,1,1).copy(k.dragStartPos),a=V({a:e,b:n,dotted:!0}),o=new t(a,r);o.computeLineDistances();var c=!1;return i.current.updateLine=function(){if(!k.isDown||e.x===k.cursorAt.x&&e.y===k.cursorAt.y&&e.z===k.cursorAt.z||(c=!0),e.copy(k.cursorAt),c){var t=V({a:e,b:n,dotted:!0});o.geometry=t}},o}));return Object(h.b)((function(){Object.values(i.current).forEach((function(e){return e()}))})),o.a.createElement("group",null,k.draggingIOID&&o.a.createElement("primitive",{object:c}))}function F(e){var t=e.link,r=n(32).LineMaterial,i=n(59).Line2,c=Object(a.useMemo)((function(){return new r({transparent:!0,color:new b.Color("#00ffff"),linewidth:.0015,opacity:.8,dashed:!0,vertexColors:!0})}),[]),s=Object(a.useRef)({}),u=Object(h.c)().scene,l=Object(a.useMemo)((function(){var e=new b.Vector3,t=new b.Vector3,n=V({a:e,b:t}),a=new i(n,c);return a.computeLineDistances(),a}),[]);return Object(a.useEffect)((function(){var e=new b.Vector3,n=new b.Vector3,a=0;s.current.updateLine=function(){var o=u.getObjectByName(t.data.input._id),r=u.getObjectByName(t.data.output._id);if(o&&r&&(o.getWorldPosition(e),r.getWorldPosition(n),a!==e.length()+n.length())){a=e.length()+n.length();var i=V({a:e,b:n});l.geometry=i}}}),[]),Object(h.b)((function(){Object.values(s.current).forEach((function(e){return e()}))})),o.a.createElement("group",null,o.a.createElement("primitive",{object:l}))}var T=function(e){var t=e.idx,n=e.io,a=void 0===n?"input":n,r=e.node,i=e.socket,c=e.e,s=e.total,u=new b.Vector3,d=new b.Vector3,f=c*-Math.PI;"output"===a&&(f=Math.PI*c),f-=2*Math.PI*.5/s,f+=1.5*Math.PI,u.setFromCylindricalCoords(6,f,0),d.setFromCylindricalCoords(10.5,f,0);return o.a.createElement("group",null,o.a.createElement("mesh",{"position-y":0,name:i._id,onPointerDown:function(e){e.stopPropagation(),e.target.setPointerCapture(e.pointerId),k.isDown=!0,k.draggingIOID={socket:JSON.parse(JSON.stringify(i)),node:JSON.parse(JSON.stringify(r))},k.dragStartPos.copy(k.cursorAt)},onPointerMove:function(e){var t=e.eventObject;t.material.emissive=new b.Color("#323232"),t.material.needsUpdate=!0},onPointerEnter:function(e){var t=e.eventObject;t.material.emissive=new b.Color("#323232"),t.material.needsUpdate=!0},onPointerLeave:function(e){var t=e.eventObject;t.material.emissive=new b.Color("#000000"),t.material.needsUpdate=!0},onPointerUp:function(e){e.stopPropagation(),e.target.releasePointerCapture(e.pointerId);var t=function(){if(k.draggingIOID&&k.draggingIOID.socket._id!==i._id&&k.draggingIOID.node._fid!==r._fid&&k.draggingIOID.socket.type!==i.type){var e=[{node:r,socket:i},Object(l.a)({},k.draggingIOID)],t=e.find((function(e){return"input"===e.socket.type})),n=e.find((function(e){return"output"===e.socket.type}));if(console.log(t,n),t&&n)return{input:t,output:n}}}();t&&R.addLink({input:t.input.socket,output:t.output.socket}),k.isDown=!1,k.draggingIOID=!1},position:u.toArray(),userData:i},o.a.createElement("sphereBufferGeometry",{args:[1,20,20]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3,color:"input"===a?"green":"blue"})),o.a.createElement("group",{position:d.toArray()},o.a.createElement("group",{"position-z":"input"===a?-.1:.1,"rotation-x":-.25*Math.PI},o.a.createElement(x.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"".concat(t)))))};function U(e){var t=e.node,n=Object(a.useRef)();return Object(h.b)((function(){n.current&&(k.draggingNodeID===t.data._id&&(t.data.position=k.cursorAt.toArray()),n.current.position.fromArray(t.data.position))})),o.a.createElement("group",{"position-y":2.75},o.a.createElement("group",{ref:n},o.a.createElement("group",{"position-z":18,"position-y":0,"rotation-x":-.25*Math.PI},o.a.createElement(x.a,{color:"#000000",fontSize:1.5,maxWidth:200,lineHeight:1,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.12,outlineColor:"#ffffff"},"".concat(t.data.title))),o.a.createElement("group",null,o.a.createElement("mesh",{raycast:w.a,onPointerDown:function(e){k.isDown=!0,k.draggingNodeID=t.data._id,k.moved=0},onPointerUp:function(e){k.isDown=!1,k.draggingNodeID=!1,R.saveCodeBlock({node:t}),k.moved<=10&&(k.currentEditNodeID=t._fid,k.overlay="node"),k.moved=0}},o.a.createElement("sphereBufferGeometry",{args:[2.75,32,32]}),o.a.createElement("meshStandardMaterial",{metalness:1,roughness:.3}))),o.a.createElement("group",{"position-z":-1.11},t.data.inputs.map((function(e,n,a){return o.a.createElement(T,{key:e._id,socket:e,node:t,idx:n,e:(n+0)/a.length,total:t.data.inputs.length+t.data.outputs.length})}))),o.a.createElement("group",{"position-z":1.11},t.data.outputs.map((function(e,n,a){return o.a.createElement(T,{io:"output",key:e._id,socket:e,node:t,idx:n,e:(n+1)/a.length,total:t.data.inputs.length+t.data.outputs.length})})))))}function W(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],r=t[1];k.makeKeyReactive("canvasOwnerID"),k.makeKeyReactive("canvasID");var i=k.canvasID,c=k.canvasOwnerID;return Object(a.useEffect)((function(){if(!i)return function(){};if(!c)return function(){};var e=N.database().ref("/canvas/".concat(i,"/").concat(c,"/nodes")).on("value",(function(e){if(e){var t=[],n=e.val();for(var a in n)t.push({_fid:a,data:n[a]});k.nodes=t,r(t)}}));return function(){e()}}),[i,c]),o.a.createElement("group",null,n.map((function(e){return o.a.createElement(U,{key:e._fid,node:e})})))}function H(){var e=Object(a.useState)([]),t=Object(g.a)(e,2),n=t[0],r=t[1];k.makeKeyReactive("canvasOwnerID"),k.makeKeyReactive("canvasID");var i=k.canvasID,c=k.canvasOwnerID;return Object(a.useEffect)((function(){return i&&c?N.database().ref("/canvas/".concat(i,"/").concat(c,"/connections")).on("value",(function(e){if(e){var t=[],n=e.val();for(var a in n)t.push({_fid:a,data:n[a]});k.connections=t,r(t)}})):function(){}}),[i,c]),o.a.createElement("group",null,n.map((function(e){return o.a.createElement(F,{key:e._fid,link:e})})))}var X=function e(t,n,a){var o=this;Object(d.a)(this,e),this.width=t,this.options=n,this.renderer=a;var r=new b.Scene,i={uniforms:{time:{value:.5}},vertexShader:"\n        varying vec3 vWorldDirection;\n        vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n          return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n        }\n        void main() {\n          vWorldDirection = transformDirection( position, modelMatrix );\n          #include <begin_vertex>\n          #include <project_vertex>\n        }\n      ",fragmentShader:"\n      varying vec3 vWorldDirection;\n\n\n        #define RECIPROCAL_PI 0.31830988618\n        #define RECIPROCAL_PI2 0.15915494\n\n        uniform float time;\n        const mat2 m = mat2( 0.80,  0.60, -0.60,  0.80 );\n\n        float noise( in vec2 p ) {\n          return sin(p.x)*sin(p.y);\n        }\n\n        float fbm4( vec2 p ) {\n            float f = 0.0;\n            f += 0.5000 * noise( p ); p = m * p * 2.02;\n            f += 0.2500 * noise( p ); p = m * p * 2.03;\n            f += 0.1250 * noise( p ); p = m * p * 2.01;\n            f += 0.0625 * noise( p );\n            return f / 0.9375;\n        }\n\n        float fbm6( vec2 p ) {\n            float f = 0.0;\n            f += 0.500000*(0.5 + 0.5 * noise( p )); p = m*p*2.02;\n            f += 0.250000*(0.5 + 0.5 * noise( p )); p = m*p*2.03;\n            f += 0.125000*(0.5 + 0.5 * noise( p )); p = m*p*2.01;\n            f += 0.062500*(0.5 + 0.5 * noise( p )); p = m*p*2.04;\n            f += 0.031250*(0.5 + 0.5 * noise( p )); p = m*p*2.01;\n            f += 0.015625*(0.5 + 0.5 * noise( p ));\n            return f/0.96875;\n        }\n\n        float pattern (vec2 p) {\n          float vout = fbm4( p + time + fbm6(  p + fbm4( p + time )) );\n          return abs(vout);\n        }\n\n\n        void main() {\n\n          vec3 direction = normalize( vWorldDirection );\n          vec2 sampleUV;\n          sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n          sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n          gl_FragColor = vec4(vec3(\n            0.35 + pattern(sampleUV * 1.70123 + -0.17 * cos(time * 0.05)),\n            0.35 + pattern(sampleUV * 1.70123 +  0.0 * cos(time * 0.05)),\n            0.35 + pattern(sampleUV * 1.70123 +  0.17 * cos(time * 0.05))\n          ), 1.0);\n\n        }\n      "},c=new b.ShaderMaterial({type:"CubemapFromEquirect",uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:b.BackSide,blending:b.NoBlending}),s=new b.Mesh(new b.BoxBufferGeometry(5,5,5),c);r.add(s);var u=new b.WebGLCubeRenderTarget(this.width,this.options),l=u.texture;u.texture.type=l.type,u.texture.format=l.format,u.texture.encoding=l.encoding,this.texture=u.texture;var f=new b.CubeCamera(1,1e5,u);f.update(this.renderer,r),this.compute=function(){i.uniforms.time.value+=1/60,f.update(o.renderer,r)}},J=function e(t){var n=this,a=t.renderer,o=t.res,r=void 0===o?128:o,i=t.color;void 0===i&&new b.Color("#ffffff");Object(d.a)(this,e),this.renderer=a,this.resX=r,this.customTarget=new X(this.resX,{format:b.RGBFormat,generateMipmaps:!0,magFilter:b.LinearFilter,minFilter:b.LinearMipmapLinearFilter},a),this.customTarget.texture.mapping=b.CubeRefractionMapping,this.customTarget.texture.mapping=b.CubeReflectionMapping,this.customTarget.texture.encoding=b.sRGBEncoding,this.compute=function(){n.customTarget.compute()},this.out={envMap:this.customTarget.texture}};function Y(){var e=Object(h.c)().get,t=Object(a.useMemo)((function(){var t=new J({renderer:e().gl,res:128,color:new b.Color("#ffffff")});return t.compute(),e().scene.environment=t.out.envMap,t}),[]);return Object(h.b)((function(){t.compute()})),null}function Q(){return o.a.createElement("group",null,o.a.createElement(A,null),o.a.createElement(B,null),o.a.createElement(W,null),o.a.createElement(H,null),o.a.createElement(K,null),o.a.createElement(G,null),o.a.createElement(Y,null),o.a.createElement("ambientLight",{intensity:.87}),o.a.createElement("directionalLight",{position:[10,10,0],intensity:.87}),o.a.createElement("ambientLight",{position:[10,10,-10],intensity:.87}))}function q(e){var t,n,o=e.setOKSize,r=Object(h.c)();return Object(a.useEffect)((function(){var e=function(){var e,t=document.querySelectorAll(".auto-resize")||[],n=Object(u.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;a&&(a.style.width="".concat(window.innerWidth,"px"),a.style.height="".concat(window.innerHeight,"px"))}}catch(o){n.e(o)}finally{n.f()}};return e(),setTimeout((function(){o(!0)})),window.addEventListener("resize",e,!1),function(){window.removeEventListener("resize",e)}}),[r,null===r||void 0===r||null===(t=r.size)||void 0===t?void 0:t.width,null===r||void 0===r||null===(n=r.size)||void 0===n?void 0:n.height]),null}function Z(e){var t=e.done,n=e.firebaseConfig;return o.a.createElement("div",{className:"auto-resize",style:{width:"".concat(window.innerWidth,"px"),height:"".concat(window.innerHeight,"px"),display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}},o.a.createElement($,{firebaseConfig:n,done:t}))}function $(e){var t=e.done,n=e.firebaseConfig;return Object(a.useEffect)((function(){return j({firebaseConfig:n}),N.auth().onAuthStateChanged((function(e){e&&t(e)}))}),[]),o.a.createElement("button",{style:{cursor:"pointer",backgroundColor:"rgba(50,50,255,1.0)",color:"white",borderRadius:"50px",padding:"20px 25px",appearance:"none",border:"none",fontSize:"20px"},className:" cursor-pointer bg-blue-500 text-white rounded-full px-6 py-3",onClick:function(){!function(){var e=new y.a.auth.GoogleAuthProvider;y.a.auth().signInWithPopup(e)}()}},"Login With Google")}function ee(e){var t=e.firebaseConfig,n=e.children,r=e.canvasID,i=void 0!==r&&r,c=Object(a.useState)("ready"),s=Object(g.a)(c,2),u=s[0],l=s[1];return Object(a.useEffect)((function(){var e=[];j({firebaseConfig:t});var n=N.auth().onAuthStateChanged((function(e){i&&e?N.database().ref("/profile/".concat(e.uid,"/canvas/").concat(i)).once("value",(function(t){var n=t.val();n&&n.ownerID===e.uid||n.shareACL[e.uid]?l("show"):l("noRights")})):l(e?"show":"needsLogin")}));return e.push(n),function(){e.forEach((function(e){return e()}))}}),[]),o.a.createElement("span",null,"show"===u&&n,"loading"===u&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"Loading"),"needsLogin"===u&&o.a.createElement(Z,{done:function(){l("show")},firebaseConfig:t}),"noRights"===u&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"No Access Rights."))}var te=function(e){var t=e.canvasID,n=e.ownerID,a=e.codes,r=void 0===a?[]:a,i=e.firebaseConfig;return o.a.createElement(ee,{firebaseConfig:i,canvasID:t},o.a.createElement(ne,{firebaseConfig:i,canvasID:t,ownerID:n,codes:r}))},ne=function(e){var t=e.canvasID,n=e.ownerID,r=e.codes,i=void 0===r?[]:r,c=e.firebaseConfig,s=Object(a.useState)(!1),u=Object(g.a)(s,2),l=u[0],d=u[1],f=Object(a.useState)(!1),p=Object(g.a)(f,2),m=p[0],v=p[1];Object(a.useEffect)((function(){k.canvasID=t,k.canvasOwnerID=n,k.firebaseConfig=c,function(e){return new Promise((function(t){var n=setInterval((function(){var a=k[e];a&&(clearInterval(n),t(a))}))}))}("firebaseConfig").then((function(e){j({firebaseConfig:e}),d(!0)}))}),[t,n]);var b=Object(a.useRef)();return o.a.createElement("div",{ref:b,className:"auto-resize",style:{width:"100%",height:"100%",position:"relative"}},o.a.createElement(h.a,{className:"auto-resize",dpr:"undefined"!==typeof window&&window.devicePixelRatio||1},o.a.createElement(q,{setOKSize:v}),l&&m&&o.a.createElement(Q,null)),l&&m&&o.a.createElement(P,{codes:i}))};function ae(e){var t=e.firebaseConfig,n=e.children,r=Object(a.useState)("ready"),i=Object(g.a)(r,2),c=i[0],s=i[1];return Object(a.useEffect)((function(){var e=[];j({firebaseConfig:t});var n=N.auth().onAuthStateChanged((function(e){s(e?"show":"needsLogin")}));return e.push(n),function(){e.forEach((function(e){return e()}))}}),[]),o.a.createElement("div",{className:"auto-resize"},"show"===c&&n,"loading"===c&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"Loading"),"needsLogin"===c&&o.a.createElement(Z,{done:function(){s("show")},firebaseConfig:t}),"noRights"===c&&o.a.createElement("div",{style:{width:"100%",height:"100%"}},"No Access Rights."))}function oe(e){var t=e.firebaseConfig,n=Object(a.useState)("New Logic Graph"),r=Object(g.a)(n,2),i=r[0],c=r[1];return o.a.createElement("div",{style:{padding:"15px",display:"flex",justifyContent:"start",alignItems:"center"}},o.a.createElement("textarea",{rows:1,style:{padding:"15px",margin:"0px"},value:i,onInput:function(e){c(e.target.value)},onChange:function(e){c(e.target.value)}}),o.a.createElement("button",{style:{padding:"15px",margin:"0px"},onClick:function(){S({firebaseConfig:t}).then((function(e){var t=e.db,n=e.user;t.ref("profile/".concat(n.uid,"/canvas")).push().set({title:i,ownerID:n.uid,shareACL:{placeholder:!1}}),k.listingReload++}))}},"Add Logic Graph"))}function re(e){var t=e.firebaseConfig,n=e.onEdit,r=void 0===n?function(){}:n;return k.makeKeyReactive("listing"),k.makeKeyReactive("listingReload"),Object(a.useEffect)((function(){S({firebaseConfig:t}).then((function(e){var t=e.user,n=e.db.ref("profile/".concat(t.uid,"/canvas")),a=function(){n.once("value",(function(e){var t=e.val();if(t){var n=[];for(var a in t)n.push({_fid:a,data:t[a]});k.listing=n}}))};a(),k.onChange("listingReload",(function(){a()}))}))}),[k.listingReload]),o.a.createElement("div",{style:{overflowX:"scroll",marginLeft:"12px"}},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"p-3 border  ",colSpan:1},o.a.createElement("span",{className:"w-24 inline-block"}),"Title"," ",o.a.createElement("span",{className:"w-24 inline-block"})),o.a.createElement("th",{className:"p-3 border  ",colSpan:1},o.a.createElement("span",{className:"w-3 inline-block"}),"CanvasID"," ",o.a.createElement("span",{className:"w-3 inline-block"})),o.a.createElement("th",{className:"p-3 border ",colSpan:3},"Actions"))),o.a.createElement("tbody",null,k.listing.map((function(e,n){return o.a.createElement("tr",{key:e._fid},o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 m-3 border bg-white "},e.data.title),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 m-3 border bg-white "},o.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){C()(e._fid)}},e._fid)),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},onClick:function(){C()("\n/* graphTitle: ".concat(e.data.title," */\n/* graphID: ").concat(e._fid," */\n").trim())}},"Copy Code")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},className:" p-3 px-6 rounded-full bg-yellow-500 text-white",onClick:function(){var n=e.data.title||"no title";S({firebaseConfig:t}).then((function(t){var a=t.user,o=t.db,r=window.prompt('Type "'.concat(n,'" to Confirm Removal, theres no restore.'),"".concat(n));r&&(r=(r||"").trim(),o.ref("profile/".concat(a.uid,"/canvas/").concat(e._fid,"/title")).set(r),e.data.title=r,k.listingReload++)}))}},"Rename")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border m-0"},o.a.createElement("button",{style:{cursor:"pointer"},className:" p-3 px-6 rounded-full bg-blue-500 text-white",onClick:function(){r({title:e.data.title,ownerID:e.data.ownerID,canvasID:e._fid})}},"Edit")),o.a.createElement("td",{style:{padding:"13px 5px"},className:"p-3 border"},o.a.createElement("button",{style:{cursor:"pointer"},className:"  p-3 px-6 rounded-full bg-red-500 text-white",onClick:function(){S({firebaseConfig:t}).then((function(t){var a=t.user,o=t.db,r=e.data.title||"no title";(window.prompt('Type "'.concat(r,'" to Confirm Removal, theres no restore.'),"".concat(r," ______"))||"").trim()===r&&(o.ref("profile/".concat(a.uid,"/canvas/").concat(e._fid)).remove(),k.listing.splice(n,1),k.listingReload++)}))}},"Remove")))})))))}function ie(e){var t=e.firebaseConfig,n=e.onEdit,a=void 0===n?function(){}:n;return o.a.createElement("div",{style:{width:"100%",backgroundColor:"white"}},o.a.createElement("div",{style:{width:"100%",backgroundColor:"rgba(255,255,255,0.92)"}},o.a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.92)"}},o.a.createElement("div",{style:{padding:"15px",fontSize:"35px",fontFamily:"Arial"}},o.a.createElement("div",null,"Project Listing"))),o.a.createElement(oe,{firebaseConfig:t}),o.a.createElement(re,{firebaseConfig:t,onEdit:a})))}var ce=function(e){var t=e.firebaseConfig;return o.a.createElement(ae,{firebaseConfig:t},o.a.createElement(ie,{firebaseConfig:t,onEdit:function(e){console.log(e)}}))},se=function(e){var t=e.firebaseConfig,n=e.codes,r=void 0===n?[]:n,i=Object(a.useState)(!1),c=Object(g.a)(i,2),s=c[0],u=c[1];return Object(a.useEffect)((function(){var e="",t=setInterval((function(){window.location.href!==e&&(e=window.location.href,function(){var e=new URLSearchParams(document.location.search).get("json");if(e)try{var t=JSON.parse(e);t&&t.canvasID&&t.ownerID?u(t):u(!1)}catch(n){console.log(n),u(!1)}else u(!1)}())}));return function(){clearInterval(t)}}),[]),o.a.createElement(ae,{firebaseConfig:t},!s&&o.a.createElement(ie,{firebaseConfig:t,onEdit:function(e){u({title:e.title,ownerID:e.ownerID,canvasID:e.canvasID}),window.history.pushState({},"encms","".concat(window.location.pathname,"?json=").concat(encodeURIComponent(JSON.stringify(e))))}}),s&&o.a.createElement(te,{firebaseConfig:t,canvasID:s.canvasID,ownerID:s.ownerID,codes:r}),s&&o.a.createElement("div",{style:{position:"absolute",top:"0px",left:"0px",zIndex:"1"}},o.a.createElement("div",{style:{margin:"12px",padding:"12px 25px",background:"white",boxShadow:"0px 0px 20px 0px #bababa",cursor:"pointer",borderRadius:"50px"},onClick:function(){u(!1),window.history.pushState({},"encms","".concat(window.location.pathname))}},"Back")),s&&o.a.createElement("div",{style:{position:"absolute",bottom:"0px",right:"0px",zIndex:"1"}},o.a.createElement("div",{style:{fontSize:"12px",margin:"7px",padding:"7px 15px",background:"white",cursor:"pointer",borderRadius:"50px",border:"gray solid 1px"}},"(",s.title,")")),!s&&o.a.createElement("div",{style:{position:"absolute",top:"0px",right:"0px",zIndex:"1"}},o.a.createElement("div",{style:{margin:"12px",padding:"12px 25px",background:"white",cursor:"pointer",boxShadow:"0px 0px 20px 0px #bababa",borderRadius:"50px"},onClick:function(){L()}},"Logout")))};function ue(){return o.a.createElement(se,{firebaseConfig:le,codes:de()})}var le={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},de=function(){var e=n(56);return function(t){var n=[];return t.keys().forEach((function(a){var o=e.basename(a);n.push({title:o,loader:function(){return t(a)}})})),n}(n(57))},fe=function(){return o.a.createElement(te,{firebaseConfig:pe,canvasID:"-MdBQtfGPXXPkl-NuEoW",ownerID:"NGpUixuU0NOkOlmLsLuepkaZxxt1",codes:me()})},pe={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},me=function(){var e=n(56);return function(t){var n=[];return t.keys().forEach((function(a){var o=e.basename(a);n.push({title:o,loader:function(){return t(a)}})})),n}(n(57))},ve=function(){return o.a.createElement(ce,{firebaseConfig:ge})},ge={apiKey:"AIzaSyAPuwK2yMl025KLVTnGDdN34XxHBYQHoVk",authDomain:"effect-node-by-you.firebaseapp.com",databaseURL:"https://en-you.firebaseio.com/",projectId:"effect-node-by-you",storageBucket:"effect-node-by-you.appspot.com",messagingSenderId:"587774316246",appId:"1:587774316246:web:2a52c46bd184fc3a1d4377",measurementId:"G-SYFGKL6VNR"},he=function(){return o.a.createElement(c.a,null,o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/project"},o.a.createElement(fe,null)),o.a.createElement(s.a,{path:"/listing"},o.a.createElement(ve,null)),o.a.createElement(s.a,{path:"/"},o.a.createElement(ue,null))))};i.a.render(o.a.createElement(he,null),document.getElementById("root"))}},[[66,2,3]]]);
//# sourceMappingURL=main.2fc91716.chunk.js.map